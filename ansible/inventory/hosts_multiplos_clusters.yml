---
# =============================================================================
# INVENTÁRIO PARA MÚLTIPLOS CLUSTERS - OpenShift Health Check
# =============================================================================
# Este arquivo demonstra como configurar múltiplos clusters no inventário.
# 
# COMO USAR:
# 1. Copie este arquivo: cp inventory/hosts_multiplos_clusters.yml inventory/hosts.yml
# 2. Edite e ajuste as URLs, tokens e nomes dos seus clusters
# 3. Execute: ansible-playbook -i inventory/hosts.yml playbooks/openshift_health_check.yml --limit openshift_clusters
#
# =============================================================================

all:
  children:
    # ========================================================================
    # GRUPO: openshift_clusters
    # ========================================================================
    # Cada cluster tem seu próprio bastion com acesso exclusivo
    # O playbook será executado remotamente em cada bastion via SSH
    # Cada bastion só tem acesso ao seu cluster específico
    # Execute em todos: --limit openshift_clusters
    # Execute em um específico: --limit development-cluster
    # ========================================================================
    openshift_clusters:
      hosts:
        # ================================================================
        # CLUSTER 1: Desenvolvimento
        # Bastion: timbiras-bastion (exemplo real)
        # ================================================================
        development-cluster:
          # Configuração de conexão SSH ao bastion específico deste cluster
          ansible_host: timbiras-bastion
          ansible_user: roberto.menezes
          ansible_ssh_private_key_file: ~/.ssh/id_rsa
          # Ou use senha (não recomendado):
          # ansible_password: "sua-senha-aqui"
          
          # Configurações do cluster OpenShift (acessível apenas deste bastion)
          openshift_cluster_url: "https://api.ocp-dev.cloud.cliente.dominio.br:6443"
          # RECOMENDADO: não versionar credenciais aqui. Passe via -e (quando rodar 1 cluster por vez)
          # ou use Ansible Vault/host_vars. Exemplos:
          # openshift_token: "{{ vault_openshift_token_dev }}"
          # openshift_username: "{{ vault_openshift_username_dev }}"
          # openshift_token: "sha256~token-dev-aqui"
          # openshift_username: "roberto.menezes"
          cluster_name: "development-cluster"
          
          # Configurações específicas de desenvolvimento (SEM análise de custos)
          max_privileged_containers: 2
          max_root_containers: 2
          min_master_nodes: 1
          min_worker_nodes: 1
          analyze_cost_optimization: false
          enable_cost_analysis: false
          collect_metrics: false
          collect_events: false
          
        # ================================================================
        # CLUSTER 2: Produção
        # Bastion: bastion-prod (exemplo)
        # ================================================================
        production-cluster:
          # Configuração de conexão SSH ao bastion específico deste cluster
          ansible_host: bastion-prod.example.com
          ansible_user: admin
          ansible_ssh_private_key_file: ~/.ssh/id_rsa
          
          # Configurações do cluster OpenShift (acessível apenas deste bastion)
          openshift_cluster_url: "https://api.production.example.com:6443"
          openshift_token: "sha256~token-producao-aqui"
          openshift_username: "usuario-producao"
          cluster_name: "production-cluster"
          
          # Configurações específicas de produção (SEM análise de custos)
          max_privileged_containers: 0
          max_root_containers: 0
          min_master_nodes: 3
          min_worker_nodes: 3
          analyze_cost_optimization: false
          enable_cost_analysis: false
          collect_metrics: true
          collect_events: true
          
        # ================================================================
        # CLUSTER 3: Staging
        # Bastion: bastion-staging (exemplo)
        # ================================================================
        staging-cluster:
          # Configuração de conexão SSH ao bastion específico deste cluster
          ansible_host: bastion-staging.example.com
          ansible_user: admin
          ansible_ssh_private_key_file: ~/.ssh/id_rsa
          
          # Configurações do cluster OpenShift (acessível apenas deste bastion)
          openshift_cluster_url: "https://api.staging.example.com:6443"
          openshift_token: "sha256~token-staging-aqui"
          openshift_username: "usuario-staging"
          cluster_name: "staging-cluster"
          
          # Configurações específicas de staging (SEM análise de custos)
          max_privileged_containers: 1
          max_root_containers: 1
          min_master_nodes: 3
          min_worker_nodes: 2
          analyze_cost_optimization: false
          enable_cost_analysis: false
          collect_metrics: true
          collect_events: true
          
        # ================================================================
        # CLUSTER 4: QA/Testes
        # Bastion: bastion-qa (exemplo)
        # ================================================================
        qa-cluster:
          # Configuração de conexão SSH ao bastion específico deste cluster
          ansible_host: bastion-qa.example.com
          ansible_user: admin
          ansible_ssh_private_key_file: ~/.ssh/id_rsa
          
          # Configurações do cluster OpenShift (acessível apenas deste bastion)
          openshift_cluster_url: "https://api.qa.example.com:6443"
          openshift_token: "sha256~token-qa-aqui"
          openshift_username: "usuario-qa"
          cluster_name: "qa-cluster"
          
          max_privileged_containers: 1
          max_root_containers: 1
          min_master_nodes: 1
          min_worker_nodes: 1
          analyze_cost_optimization: false
          enable_cost_analysis: false
          
        # ================================================================
        # CLUSTER 5: Laboratório
        # Bastion: bastion-lab (exemplo)
        # ================================================================
        lab-cluster:
          # Configuração de conexão SSH ao bastion específico deste cluster
          ansible_host: bastion-lab.example.com
          ansible_user: admin
          ansible_ssh_private_key_file: ~/.ssh/id_rsa
          
          # Configurações do cluster OpenShift (acessível apenas deste bastion)
          openshift_cluster_url: "https://api.lab.example.com:6443"
          openshift_token: "sha256~token-lab-aqui"
          openshift_username: "usuario-lab"
          cluster_name: "lab-cluster"
          
          max_privileged_containers: 5
          max_root_containers: 5
          min_master_nodes: 1
          min_worker_nodes: 1
          analyze_cost_optimization: false
          enable_cost_analysis: false
          collect_metrics: false
          collect_events: false

# =============================================================================
# EXEMPLOS DE EXECUÇÃO
# =============================================================================
#
# IMPORTANTE: Cada cluster tem seu próprio bastion. O playbook será executado
# remotamente em cada bastion via SSH, e cada bastion só tem acesso ao seu
# cluster específico.
#
# 1. EXECUTAR EM TODOS OS CLUSTERS (via seus bastions):
#    ansible-playbook -i inventory/hosts.yml playbooks/openshift_health_check.yml \
#      --limit openshift_clusters
#
# 2. EXECUTAR EM UM CLUSTER ESPECÍFICO (via seu bastion):
#    ansible-playbook -i inventory/hosts.yml playbooks/openshift_health_check.yml \
#      --limit development-cluster
#    # Isso executará no bastion timbiras-bastion para o cluster dev
#
# 3. EXECUTAR EM MÚLTIPLOS CLUSTERS ESPECÍFICOS:
#    ansible-playbook -i inventory/hosts.yml playbooks/openshift_health_check.yml \
#      --limit "production-cluster,staging-cluster"
#    # Cada cluster será executado em seu próprio bastion
#
# 4. EXECUTAR COM TAGS ESPECÍFICAS (apenas segurança):
#    ansible-playbook -i inventory/hosts.yml playbooks/openshift_health_check.yml \
#      --limit openshift_clusters \
#      --tags seguranca
#
# 5. EXECUTAR EM MODO PARALELO (mais rápido):
#    ansible-playbook -i inventory/hosts.yml playbooks/openshift_health_check.yml \
#      --limit openshift_clusters \
#      --forks 5
#    # Executa em até 5 bastions simultaneamente
#
# 6. TESTAR CONECTIVIDADE SSH COM OS BASTIONS:
#    ansible -i inventory/hosts.yml openshift_clusters -m ping
#
# 7. USAR O SCRIPT AUTOMATIZADO:
#    ./ansible/examples/run_health_check_multiple_clusters.sh
#    ./ansible/examples/run_health_check_multiple_clusters.sh -c development-cluster
#    ./ansible/examples/run_health_check_multiple_clusters.sh -l  # Listar clusters
#
# =============================================================================
# NOTAS IMPORTANTES
# =============================================================================
#
# - Cada cluster precisa ter um nome único (cluster_name)
# - Cada cluster tem seu próprio bastion (ansible_host)
# - Cada bastion só tem acesso ao seu cluster específico
# - O playbook será executado remotamente em cada bastion via SSH
# - Os relatórios serão salvos em: reports/{cluster_name}_{timestamp}/
# - Para proteger tokens, use Ansible Vault
# - Execute em modo dry-run primeiro: --check
# - Use --forks para executar em paralelo (acelera execução)
# - Certifique-se de que o código do playbook está disponível em cada bastion
#   (ou use ansible-playbook com --become para copiar via SCP)
#
# =============================================================================
