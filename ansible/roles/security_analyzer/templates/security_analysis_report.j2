# VerificaÃ§Ã£o de SaÃºde OpenShift - RelatÃ³rio de AnÃ¡lise de SeguranÃ§a

## Resumo da AnÃ¡lise

**Timestamp da AnÃ¡lise:** {{ security_analysis.analysis_timestamp }}  
**URL do Cluster:** {{ security_analysis.cluster_url }}  
**PontuaÃ§Ã£o Geral de SeguranÃ§a:** {{ security_analysis.overall_security_score }}/100  

## Status da AnÃ¡lise

| Componente | Status |
|------------|--------|
| AnÃ¡lise RBAC | {{ 'âœ“ Sucesso' if security_analysis_status.rbac_analysis else 'âœ— Falhou' }} |
| SeguranÃ§a de Rede | {{ 'âœ“ Sucesso' if security_analysis_status.network_security else 'âœ— Falhou' }} |
| SeguranÃ§a de Pods | {{ 'âœ“ Sucesso' if security_analysis_status.pod_security else 'âœ— Falhou' }} |
| Gerenciamento de Segredos | {{ 'âœ“ Sucesso' if security_analysis_status.secrets_management else 'âœ— Falhou' }} |
| AnÃ¡lise de Conformidade | {{ 'âœ“ Sucesso' if security_analysis_status.compliance_analysis else 'âœ— Falhou' }} |

## AnÃ¡lise RBAC

{% if security_analysis_status.rbac_analysis %}
- **Total de Roles do Cluster:** {{ security_analysis.rbac_analysis.cluster_roles.total_cluster_roles }}
- **Roles de Administrador do Cluster:** {{ security_analysis.rbac_analysis.cluster_roles.cluster_admin_roles }}
- **Roles do Sistema:** {{ security_analysis.rbac_analysis.cluster_roles.system_roles }}
- **Roles Personalizados:** {{ security_analysis.rbac_analysis.cluster_roles.custom_roles }}
- **Total de VinculaÃ§Ãµes de Roles do Cluster:** {{ security_analysis.rbac_analysis.cluster_role_bindings.total_bindings }}
- **VinculaÃ§Ãµes de Administrador do Cluster:** {{ security_analysis.rbac_analysis.cluster_role_bindings.cluster_admin_bindings }}
- **Total de Contas de ServiÃ§o:** {{ security_analysis.rbac_analysis.service_accounts.total_service_accounts }}

{% if security_analysis.rbac_analysis.excessive_permissions | length > 0 %}
### PermissÃµes Excessivas
{% for permission in security_analysis.rbac_analysis.excessive_permissions %}
- âš ï¸ {{ permission }}
{% endfor %}
{% endif %}

{% if security_analysis.rbac_analysis.privileged_accounts | length > 0 %}
### Contas Privilegiadas
{% for account in security_analysis.rbac_analysis.privileged_accounts %}
- âš ï¸ {{ account }}
{% endfor %}
{% endif %}

{% if security_analysis.rbac_analysis.issues | length > 0 %}
### Problemas RBAC
{% for issue in security_analysis.rbac_analysis.issues %}
- âš ï¸ {{ issue }}
{% endfor %}
{% endif %}
{% else %}
âŒ AnÃ¡lise RBAC falhou
{% endif %}

## AnÃ¡lise de SeguranÃ§a de Pods

{% if security_analysis_status.pod_security %}
- **Total de Pods:** {{ security_analysis.pod_security.privileged_containers + security_analysis.pod_security.root_containers + security_analysis.pod_security.host_network_pods }}
- **Containers Privilegiados:** {{ security_analysis.pod_security.privileged_containers }}
- **Containers Root:** {{ security_analysis.pod_security.root_containers }}
- **Pods com Rede do Host:** {{ security_analysis.pod_security.host_network_pods }}
- **Pods com PID do Host:** {{ security_analysis.pod_security.host_pid_pods }}
- **Pods com IPC do Host:** {{ security_analysis.pod_security.host_ipc_pods }}
- **RestriÃ§Ãµes de Contexto de SeguranÃ§a:** {{ security_analysis.pod_security.security_context_constraints.total_sccs }}
- **PolÃ­ticas de SeguranÃ§a de Pods:** {{ security_analysis.pod_security.pod_security_policies }}

{% if security_analysis.pod_security.pod_security_issues | length > 0 %}
### Problemas de SeguranÃ§a de Pods
{% for issue in security_analysis.pod_security.pod_security_issues %}
- âš ï¸ {{ issue }}
{% endfor %}
{% endif %}
{% else %}
âŒ AnÃ¡lise de seguranÃ§a de pods falhou
{% endif %}

## RecomendaÃ§Ãµes de SeguranÃ§a

### Alta Prioridade
{% if security_analysis_status.rbac_analysis and security_analysis.rbac_analysis.cluster_role_bindings.cluster_admin_bindings > 3 %}
- Reduzir o uso do role cluster-admin ao mÃ­nimo necessÃ¡rio
{% endif %}
{% if security_analysis_status.pod_security and security_analysis.pod_security.privileged_containers > 0 %}
- Remover containers privilegiados ou implementar contextos de seguranÃ§a adequados
{% endif %}
{% if security_analysis_status.pod_security and security_analysis.pod_security.root_containers > 0 %}
- Evitar executar containers como usuÃ¡rio root
{% endif %}

### MÃ©dia Prioridade
{% if security_analysis_status.rbac_analysis and security_analysis.rbac_analysis.excessive_permissions | length > 0 %}
- Revisar e minimizar permissÃµes excessivas
{% endif %}
{% if security_analysis_status.pod_security and security_analysis.pod_security.host_network_pods > 0 %}
- Evitar usar rede do host para pods quando possÃ­vel
{% endif %}

### Baixa Prioridade
{% if security_analysis_status.rbac_analysis and security_analysis.rbac_analysis.privileged_accounts | length > 0 %}
- Revisar contas de serviÃ§o com privilÃ©gios elevados
{% endif %}

## Detalhamento da PontuaÃ§Ã£o de SeguranÃ§a

**PontuaÃ§Ã£o Geral:** {{ security_analysis.overall_security_score }}/100

{% if security_analysis.overall_security_score >= 90 %}
ğŸŸ¢ **Excelente** - A seguranÃ§a do cluster estÃ¡ bem configurada
{% elif security_analysis.overall_security_score >= 70 %}
ğŸŸ¡ **Bom** - Algumas melhorias de seguranÃ§a recomendadas
{% elif security_analysis.overall_security_score >= 50 %}
ğŸŸ  **Regular** - VÃ¡rias questÃµes de seguranÃ§a precisam de atenÃ§Ã£o
{% else %}
ğŸ”´ **Ruim** - Melhorias significativas de seguranÃ§a necessÃ¡rias
{% endif %}

## EstatÃ­sticas da AnÃ¡lise

{% set success_count = 0 %}
{% set total_count = 0 %}
{% for key, value in security_analysis_status.items() %}
{% set total_count = total_count + 1 %}
{% if value %}
{% set success_count = success_count + 1 %}
{% endif %}
{% endfor %}

**Total de Componentes de AnÃ¡lise:** {{ total_count }}  
**AnÃ¡lises Bem-sucedidas:** {{ success_count }}  
**AnÃ¡lises Falharam:** {{ total_count - success_count }}  
**Taxa de Sucesso:** {{ ((success_count / total_count) * 100) | round(2) }}%  

## Notas

{% if success_count < total_count %}
âš ï¸ **Aviso:** Algumas tarefas de anÃ¡lise de seguranÃ§a falharam. A anÃ¡lise pode estar incompleta.
{% else %}
âœ… **Sucesso:** Todas as tarefas de anÃ¡lise de seguranÃ§a foram concluÃ­das com sucesso.
{% endif %}

Este relatÃ³rio foi gerado automaticamente pelo playbook de VerificaÃ§Ã£o de SaÃºde OpenShift do Ansible.
